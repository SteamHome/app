"use strict";function userTooltip(){if(0!==$("#userNav").length&&0===$("#userNav .icon-steam").length){var e;e=new Drop({target:document.querySelector("#userNav"),content:'Not you? <a href="/auth">Click here!</a>',position:"bottom right",openOn:"click",classes:"drop-theme-twipsy userNav__drop",tetherOptions:{offset:"18px 10px"}}),e.open()}}function search(e){switch(searchService){case"youtube":document.location="https://www.youtube.com/results?search_query="+e;break;case"reddit":document.location="https://www.reddit.com/search?q="+e+"&sort=relevance&t=all";break;case"google images":document.location="https://www.google.com/search?tbm=isch&q="+e;break;case"steam store":document.location="http://store.steampowered.com/search/?snr=1_4_4__12&term="+e;break;case"steam community":document.location="https://steamcommunity.com/search/?text="+e;break;case"google":default:document.location="https://www.google.com/search?q="+e}}function displayLinks(e){$(".links").empty(),$.each(e,function(t){$(".links").append('<a href="'+e[t].url+'" class="link__'+e[t].type+'">'+e[t].name+"</a>")})}function setAppName(e){$(".appName").text(e)}function loadApp(){$(".layout-transparent").css("background-image","url(https://steamcdn-a.akamaihd.net/steam/apps/"+appid+"/page_bg_generated_v6b.jpg)"),fetch("https://gamelinks.steamho.me/"+appid+".json").then(function(e){return 200!==e.status?(console.log("✘ HTTP Error "+e.status+" fetching links for appid "+appid),void e.json().then(function(e){"Not Found"===e.status&&$(".error-appNotFound").css("display","flex")})):void e.json().then(function(e){console.log("✓ Link Parsing for appid "+appid),console.log("i App Debug Info",e.build),setAppName(e.name),displayLinks(e.links)})})["catch"](function(e){console.log("✘ Error fetching links for appid "+appid,e)})}var appid,searchService;$(".search__service").on("click",function(){searchService=$(this).attr("data-search"),$("#searchLabel").text(searchService)}),$("#search").submit(function(e){search($("#searchQuery").val()),e.preventDefault()}),$("#getID").on("submit",function(e){e.preventDefault(),$.post("/getid/",{input:$("#idQuery").val()},function(e){document.location=document.location.origin+e.url},"json")}),$("#userlinksForm").on("submit",function(e){e.preventDefault();for(var t=5,a=0,s=[];t>a;){var o={},n=$("#userlink"+a+"-title").val(),r=$("#userlink"+a).val();o[n]=r,s.push(o),a++}$.ajax({type:"post",url:"/userlinks",data:{links:JSON.stringify(s)},success:function(e){e.success?($("#userlinksForm .status").text("Successfully saved links"),console.log("Success")):($("#userlinksForm .status").text("There was an error saving links"),console.log("Failure"))},error:function(e,t,a){$("#userlinksForm .status").text("There was an error saving links"),console.log("Failure: ",t)}})}),$(window).load(function(){$("body").hasClass("about")&&($(".welcome video").get(0).play(),$(".layout-transparent").hasClass("is-small-screen")&&$(".welcome video").attr("controls","true"))}),$(document).ready(function(){"Login"!==$("#userNav").text()&&userTooltip(),"true"===$("body").attr("data-ingame")?(appid=$("body").attr("data-appid"),setAppName($("body").attr("data-appname")),loadApp()):"false"===$("body").attr("data-ingame")&&$(".error-notPlaying").css("display","flex")});
